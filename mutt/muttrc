# ~/.mutt/muttrc
# Gerard Marull-Paretas - teslabs.com

# note: heavily based on jason ryan's configuration

# directories
  set alias_file          = ~/.mutt/alias
  set header_cache        = ~/.mutt/cache/headers
  set message_cachedir    = ~/.mutt/cache/bodies
  set certificate_file    = ~/.mutt/certificates
  set mailcap_path        = ~/.mutt/mailcap
  set signature           = ~/.mutt/signature
  set tmpdir              = ~/.mutt/temp

# main options
  set mbox_type           = Maildir
  set folder              = ~/mail
  set spoolfile           = "+teslabs/INBOX"
  set timeout             = 3
  set mail_check          = 0
  set sort_alias          = alias
  set reverse_alias
unset move
  set delete
unset confirmappend
  set quit
unset mark_old
  set beep_new
  set pipe_decode
  set thorough_search
  set text_flowed         = yes
unset help
  set editor              = "vim -c 'set tw=80 ft=mail' -c 'set wrap' -c 'set nocp' -c '+/^--.$/-1'"

# index options
  set sort                = threads
  set sort_aux            = reverse-last-date-received
  set uncollapse_jump
  set sort_re
  set reply_regexp        = "^(([Rr][Ee]?(\[[0-9]+\])?: *)?(\[[^]]+\] *)?)*"

# pager options
  set pager_index_lines   = 10
  set pager_context       = 5
  set pager_stop
  set menu_scroll
  set smart_wrap
  set tilde
unset markers
  set quote_regexp        = "^( {0,4}[>|:#%]| {0,4}[a-z0-9]+[>|]+)+"
  set status_on_top

# formats
  set date_format         = "%d/%m/%y at %I:%M%P"
  set index_format        = "%3C  %S   %D  â€¢  %-25.25L %s %> %c"
  set pager_format        = "Reading message %C of %m %> %lL [%P]"
  set folder_format       = "%2C %t %N %8s %d %f"
  set status_format       = " %?M?%M/?%m Mails %?n?%n new, ?%?u?%u unread, ?%?p?%p drafts, ?%?t?%t +tagged, ?%?d?%d deleted, ?[%f %l]  %?b?%b unread messages. ?%>  %V  [%P]"
  set alias_format        = "%4n %t %-20a  %r"

# composing mail
  set realname            = "Gerard Marull-Paretas"
  set envelope_from
  set sig_dashes
  set edit_headers
  set fast_reply
  set sendmail_wait       = -1
  set forward_format      = "Fwd: %s"
  set forward_decode
  set attribution         = "On %d, %n wrote:"
  set reverse_name
  set include
  set forward_quote

# headers to show
ignore *
unignore from: to: cc: date: subject:
hdr_order from: to: cc: date: subject:

# boxes
mailboxes +teslabs/INBOX \
          +teslabs/archive \
          +teslabs/sent \
          +teslabs/draft \
          +teslabs/trash \
          +teslabs/spam

# always sourced
source $alias_file
source ~/.mutt/colors
source ~/.mutt/gpg
source ~/.mutt/accounts/teslabs

# account specific sources
folder-hook teslabs/* source ~/.mutt/accounts/teslabs

# bindings
bind index i            noop
bind pager q            exit
bind pager /            search
bind pager <up>         previous-line
bind pager <down>       next-line
bind pager k            previous-line
bind pager j            next-line
bind pager gg           top
bind pager G            bottom
bind index gg           first-entry
bind index G            last-entry
bind pager K            previous-undeleted
bind pager J            next-undeleted
bind index K            previous-unread
bind index J            next-unread
bind index W            clear-flag
bind index w            set-flag
bind index,pager R      group-reply
bind compose p          pgp-menu
bind attach <return>    view-mailcap

# macros
macro index gh \
    "<change-folder> =teslabs/INBOX<enter>" \
    "go to inbox"

macro compose Y \
    pfy \
    "send mail without pgp"

macro index o \
    "<shell-escape>mbsync -a<enter>" \
    "sync all IMAP accounts"

